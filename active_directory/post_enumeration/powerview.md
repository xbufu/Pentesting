# PowerView

More useful commands: https://gist.github.com/HarmJ0y/184f9822b195c52dd50c379ed3117993

## Domains

```powershell
# Get current domain
Get-NetDomain

# Get object of another domain
Get-NetDomain -Domain lab.local

# Get domain SID for current domain
Get-DomainSID

# Get domain policy for current domain
Get-DomainPolicy
(Get-DomainPolicy)."System Access"

# Get domain policy for another domain
(Get-DomainPolicy -Domain lab.local)."System Access"

# Get domain controllers for current domain
Get-NetDomainController

# Get domain controllers for another domain
Get-NetDomainController -Domain lab.local
```

## Users

```powershell
# Get list of users in current domain
Get-NetUser
Get-NetUser -Username student1

# Get list of all properties for users in current domain
Get-UserProperty
Get-UserProperty -Properties pwdlastset

# Search for a particular string in a user's attributes
Find-UserField -SearchFiled Description -SearchTerm "built"

# Get actively logged on users on a computer (needs local admin rights on the target)
Get-NetLoggedOn -ComputerName dc.lab.local

# Get actively logged on users on a computer (needs remote registry on the target - started by default on server OS)
Get-LoggedOnLocal -ComputerName dc.lab.local

# Get the last logged user on a computer (needs administrative rights and remote registry on the target)
Get-LastLoggedOn -ComputerName dc.lab.local
```

## Computers

```powershell
# Get list of computers in current domain
Get-NetComputer
Get-NetComputer -OperatingSystem "*Server 2016"
Get-NetComputer -Ping
Get-NetComputer -FullData
```

## Groups

```powershell
# Get all groups in current domain
Get-NetGroup
Get-NetGroup -Domain lab.local
Get-NetGroup -FullData

# Get all groups containing the word "admin" in group name
Get-NetGroup "*admin*"

# Get all members of Domain Admins group
Get-NetGroupMember -GroupName "Domain Admins" -Recurse

# Get group membership for a user
Get-NetGroup -UserName "student1"

# List all local groups on a machine (needs administrator privileges on non-dc machines)
Get-NetLocalGroup -ComputerName dc.lab.local -ListGroups

# Get members of a ll local groups on a machine (needs administrator privileges on non-dc machines)
Get-NetLocalGroup -ComputerName dc.lab.local -Recurse
```

## Files & Shares

```powershell
# Find shares on hosts in current domain
Invoke-ShareFinder -Verbose

# Find sensitive files on computers in the domain
Invoke-FileFinder -Verbose

# Get all fileservers of the domain
Get-NetFileServer
```
